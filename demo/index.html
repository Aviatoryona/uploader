<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>title</title>
</head>
<body>
    <input id="select-file" type="file" multiple>
    <button id="upload">upload</button>
    <div class="progress"></div>
    <div class="imgs"></div>
    <script src="uploader.min.js" type="text/javascript"></script>
    <script type="text/javascript">
    var input = document.querySelector('#select-file');
    var btn = document.querySelector('#upload');
    var content = document.querySelector('.imgs');
    var progress = document.querySelector('.progress');
    var domain = 'http://localhost:8888';
    var u = new Uploader({
        url: domain + '/upload',
        params: {
            m: 'C',
            pub: 1,
            picType: 2
        },
        formData: {
            haha: 'hahahahaahah'
        },
        multiple: true,
    });
    // u.bind(btn);
    u.addData('haha', 'yoyoyoyoyo');
    u.on('upload.success', function (data) {
        var imgs = data.data;
        imgs.forEach(function (item) {
            var img = document.createElement('img');
            img.setAttribute('src', domain + item);
            img.style.width = '300px';
            content.appendChild(img);
        });
    }).on('upload.progress', function (event, percent) {
        progress.innerHTML = percent;
    }).on('upload.start', function () {
        console.log('start');
    }).on('upload.addFile', function (f) {
        console.log('add file', f)
    });
    input.addEventListener('change', function (event) {
        if (input.files.length) {
            var arr = [];
            for (var i in input.files) {
                if (input.files.hasOwnProperty(i)) {
                    arr.push(input.files[i]);
                }
            }
            // var u = new Uploader({
            //     url: 'http://localhost:8888/upload',
            //     params: {
            //         m: 'C',
            //         pub: 1,
            //         picType: 2
            //     },
            //     formData: {
            //         haha: 'hahahahaahah'
            //     },
            //     multiple: true,
            //     auto: true,
            //     files: arr,
            // });
            // u.on('upload.error', function () {
            //     console.log('ee');
            // })
            u.addFile('file', input.files[0], input.files[0].name);
            console.log(u);
        }
    });
    btn.addEventListener('click', function () {
        // console.log(u.files);
        u.start();
    });
    </script>
</body>
</html>