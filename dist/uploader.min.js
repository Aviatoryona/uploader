!function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[o]={exports:{}};e[o][0].call(f.exports,function(t){var r=e[o][1][t];return a(r?r:t)},f,f.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var a=t("./lib/uploader.js"),i=n(a);window.Uploader=i["default"]},{"./lib/uploader.js":3}],2:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./util"),s=n(o),u=function(){function t(e){var r=this;a(this,t);var n={url:null,method:"GET",params:{},data:null,xhr:new XMLHttpRequest,status:"pending",callbackList:[],headers:{}};if("undefined"==typeof XMLHttpRequest)return void t.Error("NOT_SUPPORT");if(s.extend(this,n,e),this.xhr.addEventListener("load",function(){var t=r.xhr.response;if(r.status="complete",200===r.xhr.status){try{t=JSON.parse(t)}catch(e){}r.emit("success",t)}else r.emit("error",r.xhr)}),this.xhr.addEventListener("progress",function(t){var e=void 0;r.status="uploading",e=t.lengthComputable?t.loaded/t.total:0,r.emit("progress",t,e)}),this.xhr.addEventListener("error",function(t){r.emit("error",t)}),this.xhr.addEventListener("abort",function(t){r.emit("abort",t)}),s.notEmpty(this.headers)){var i=!0,o=!1,u=void 0;try{for(var l,f=Object.keys(this.headers)[Symbol.iterator]();!(i=(l=f.next()).done);i=!0){var c=l.value;this.setHeader(c,this.headers[c])}}catch(d){o=!0,u=d}finally{try{!i&&f["return"]&&f["return"]()}finally{if(o)throw u}}}return this}return i(t,[{key:"send",value:function(){if(!this.url)return void t.Error("NO_URL");var e=this.url,r=[];for(var n in this.params)this.params.hasOwnProperty(n)&&r.push(n+"="+this.params[n]);if(e=r.length?e+"?"+r.join("&"):e,this.xhr.open(this.method,e),s.notEmpty(this.headers))for(var n in this.headers)this.headers.hasOwnProperty(n)&&this.xhr.setRequestHeader(n,this.headers[n]);return this.xhr.send(this.data),this}},{key:"abort",value:function(){return this.xhr.abort(),this}},{key:"setHeader",value:function(t,e){return this.headers[t]=e,this}},{key:"on",value:function(t,e,r,n){return this.callbackList[t]=this.callbackList[t]||[],this.callbackList[t].push({fn:e,context:r,once:n}),this}},{key:"emit",value:function(t){if(this.callbackList[t]&&this.callbackList[t].length){for(var e=0,r=this.callbackList[t],n=arguments.length,a=Array(n>1?n-1:0),i=1;n>i;i++)a[i-1]=arguments[i];for(;e<r.length;e+=1){var o=r[e];o.fn.apply(o.context,a),o.once&&(r.splice(e,1),e-=1)}}}}],[{key:"Error",value:function(t){var e=void 0;switch(t){case"NOT_SUPPORT":e="Browser not support XMLHttpRequest.";break;case"NO_URL":e="No url provided."}if(e)throw"Ajax Error: "+e}}]),t}();r["default"]=u},{"./util":4}],3:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),f=function m(t,e,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:m(a,e,r)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(r)};Object.defineProperty(r,"__esModule",{value:!0});var c=t("./ajax"),d=a(c),h=t("./util"),p=n(h),v={files:[],limit:"*",formData:{},multiple:!1,auto:!1,method:"POST",progressEvent:!0},y=function(t){function e(t){o(this,e);var r=s(this,Object.getPrototypeOf(e).call(this,p.extend(v,t)));if("undefined"==typeof FormData)return e.Error("NOT_SUPPORT","FormData"),s(r);if("undefined"==typeof File)return e.Error("NOT_SUPPORT","File"),s(r);if("undefined"==typeof Blob)return e.Error("NOT_SUPPORT","Blob"),s(r);r.data=new FormData,r.progressEvent&&(r.upload=r.xhr.upload,r.upload.addEventListener("progress",function(t){var e=void 0;r.status="uploading",e=t.lengthComputable?t.loaded/t.total:0,r.emit("upload.progress",t,e)}),r.upload.addEventListener("error",function(t){r.status="error",r.emit("upload.error",t)}),r.upload.addEventListener("abort",function(t){r.status="abort",r.emit("upload.abort",t)})),r.on("success",function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];r.status="success",r.emit.apply(r,["upload.success"].concat(e))}),r._files=[];var n=!0,a=!1,i=void 0;try{for(var u,l=Object.keys(r.formData)[Symbol.iterator]();!(n=(u=l.next()).done);n=!0){var f=u.value;r.addData(f,r.formData[f])}}catch(c){a=!0,i=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw i}}return r.auto&&r.start(),r}return u(e,t),l(e,[{key:"addFile",value:function(t,e,r){var n=!1,a=e.name,o=a.split(".").pop();if(p.isArray(this.limit)){for(var s=0,u=this.limit.length;u>s;s+=1)if(o===this.limit[s]){n=!0;break}}else("*"===this.limit||o===this.limit)&&(n=!0);return n?(this._files.push(i({},r,e)),this.formData[r]=e,this.data.append(t,e,r),this.emit("upload.addFile",e)):this.emit("upload.fileExtnameNotMatch",e),this}},{key:"addData",value:function(t,e){return this.formData[t]=e,this.data.append(t,e),this.emit("upload.addData",i({},t,e)),this}},{key:"start",value:function(){return this.files.length?this.url?(f(Object.getPrototypeOf(e.prototype),"send",this).call(this),this.emit("upload.start"),this):void e.Error("NO_URL"):void e.Error("NO_FILES")}},{key:"bind",value:function(t){var r=this;if(!t)return void e.Error("NO_ELEMENT");var n=document.createElement("input");return n.setAttribute("type","file"),this.multiple&&n.setAttribute("multiple",!0),n.addEventListener("change",function(){if(n.files.length){var t=!0,e=!1,a=void 0;try{for(var i,o=Object.keys(n.files)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;r.addFile("file",n.files[s],n.files[s].name)}}catch(u){e=!0,a=u}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw a}}r.start()}}),t.addEventListener("click",function(){n.click()}),this}},{key:"reset",value:function(){this.formData={},this._files=[],this.files=[],this.status="pending",this.data=new FormData}},{key:"files",get:function(){return this._files},set:function(t){var e=this;if(p.isArray(t)&&t.length){var r=this.formData,n={},a=!0,i=!1,o=void 0;try{for(var s,u=Object.keys(r)[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value,f=r[l];f instanceof File||f instanceof Blob||(n[l]=f)}}catch(c){i=!0,o=c}finally{try{!a&&u["return"]&&u["return"]()}finally{if(i)throw o}}this.reset(),this.formData=n;var d=!0,h=!1,v=void 0;try{for(var y,m=Object.keys(this.formData)[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var l=y.value;this.data.append(l,this.formData[l])}}catch(c){h=!0,v=c}finally{try{!d&&m["return"]&&m["return"]()}finally{if(h)throw v}}t.forEach(function(t){e.addFile("file",t,t.name||"file")})}}}],[{key:"Error",value:function(t){var e=void 0;switch(t){case"NOT_SUPPORT":e="Browser not support "+(arguments.length<=1?void 0:arguments[1]);break;case"NOT_INIT":e="Uploader haven't inited.";break;case"NO_FILES":e="Target file is empty.";break;case"NO_URL":e="No upload url provided.";break;case"NO_ELEMENT":e="No element to trigger select file."}if(e)throw"Uploader Error: "+e}}]),e}(d["default"]);r["default"]=y},{"./ajax":2,"./util":4}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.extend=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;e>n;n++)r[n-1]=arguments[n];var a=!0,i=!1,o=void 0;try{for(var s,u=r[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value;for(var f in l)l.hasOwnProperty(f)&&(t[f]=l[f])}}catch(c){i=!0,o=c}finally{try{!a&&u["return"]&&u["return"]()}finally{if(i)throw o}}return t},r.notEmpty=function(t){var e=void 0,r=!1;if(Object.keys)r=!!Object.keys(t).length;else for(e in t)if(t.hasOwnProperty(e)){r=!0;break}return r},r.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}},{}]},{},[1]);
//# sourceMappingURL=uploader.min.js.map
