!function t(e,r,n){function i(o,u){if(!r[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var f=r[o]={exports:{}};e[o][0].call(f.exports,function(t){var r=e[o][1][t];return i(r?r:t)},f,f.exports,t,e,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var i=t("./lib/uploader.js"),a=n(i);window.Uploader=a["default"]},{"./lib/uploader.js":3}],2:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();Object.defineProperty(r,"__esModule",{value:!0});var o=t("./util"),u=n(o),l={url:null,method:"GET",params:{},data:null,xhr:new XMLHttpRequest,status:"pending",callbackList:[],headers:{}},s=function(){function t(e){var r=this;if(i(this,t),"undefined"==typeof XMLHttpRequest)return void t.Error("NOT_SUPPORT");if(u.extend(this,l,e),this.xhr.addEventListener("load",function(){var t=r.xhr.response;if(r.status="complete",200===r.xhr.status){try{t=JSON.parse(t)}catch(e){}r.emit("success",t)}else r.emit("error",r.xhr)}),this.xhr.addEventListener("progress",function(t){var e=void 0;r.status="uploading",e=t.lengthComputable?t.loaded/t.total:0,r.emit("progress",t,e)}),this.xhr.addEventListener("error",function(t){r.emit("error",t)}),this.xhr.addEventListener("abort",function(t){r.emit("abort",t)}),u.notEmpty(this.headers)){var n=!0,a=!1,o=void 0;try{for(var s,f=Object.keys(this.headers)[Symbol.iterator]();!(n=(s=f.next()).done);n=!0){var c=s.value;this.setHeader(c,this.headers[c])}}catch(d){a=!0,o=d}finally{try{!n&&f["return"]&&f["return"]()}finally{if(a)throw o}}}return this}return a(t,[{key:"send",value:function(){if(!this.url)return void t.Error("NO_URL");var e=this.url,r=[];for(var n in this.params)this.params.hasOwnProperty(n)&&r.push(n+"="+this.params[n]);if(e=e+"?"+r.join("&"),this.xhr.open(this.method,e),u.notEmpty(this.headers))for(var n in this.headers)this.headers.hasOwnProperty(n)&&this.xhr.setRequestHeader(n,this.headers[n]);return this.xhr.send(this.data),this}},{key:"abort",value:function(){return this.xhr.abort(),this}},{key:"setHeader",value:function(t,e){return this.headers[t]=e,this}},{key:"on",value:function(t,e,r,n){return this.callbackList[t]=this.callbackList[t]||[],this.callbackList[t].push({fn:e,context:r,once:n}),this}},{key:"emit",value:function(t){if(this.callbackList[t]&&this.callbackList[t].length){for(var e=0,r=this.callbackList[t],n=arguments.length,i=Array(n>1?n-1:0),a=1;n>a;a++)i[a-1]=arguments[a];for(;e<r.length;e+=1){var o=r[e];o.fn.apply(o.context,i),o.once&&(r.splice(e,1),e-=1)}}}}],[{key:"Error",value:function(t){var e=void 0;switch(t){case"NOT_SUPPORT":e="Browser not support XMLHttpRequest.";break;case"NO_URL":e="No url provided."}if(e)throw"Ajax Error: "+e}}]),t}();r["default"]=s},{"./util":4}],3:[function(t,e,r){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),f=function b(t,e,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:b(i,e,r)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(r)};Object.defineProperty(r,"__esModule",{value:!0});var c=t("./ajax"),d=i(c),h=t("./util"),p=n(h),v={files:[],limit:"*",formData:{},multiple:!1,auto:!1,method:"POST"},y=function(t){function e(t){o(this,e);var r=u(this,Object.getPrototypeOf(e).call(this,p.extend(v,t)));if("undefined"==typeof FormData)return e.Error("NOT_SUPPORT","FormData"),u(r);if("undefined"==typeof File)return e.Error("NOT_SUPPORT","File"),u(r);if("undefined"==typeof Blob)return e.Error("NOT_SUPPORT","Blob"),u(r);r.data=new FormData,r.upload=r.xhr.upload,r.upload.addEventListener("progress",function(t){var e=void 0;r.status="uploading",e=t.lengthComputable?t.loaded/t.total:0,r.emit("upload.progress",t,e)}),r.upload.addEventListener("error",function(t){r.emit("upload.error",t)}),r.upload.addEventListener("abort",function(t){r.emit("upload.abort",t)}),r.on("success",function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];r.emit.apply(r,["upload.success"].concat(e))});var n=r.files;r.files=[];var i=!0,a=!1,l=void 0;try{for(var s,f=n[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var c=s.value;(c instanceof File||c instanceof Blob)&&r.addFile("file",c,c.name||"file")}}catch(d){a=!0,l=d}finally{try{!i&&f["return"]&&f["return"]()}finally{if(a)throw l}}var h=!0,y=!1,b=void 0;try{for(var m,O=Object.keys(r.formData)[Symbol.iterator]();!(h=(m=O.next()).done);h=!0){var c=m.value;r.addData(c,r.formData[c])}}catch(d){y=!0,b=d}finally{try{!h&&O["return"]&&O["return"]()}finally{if(y)throw b}}return r.auto&&r.start(),r}return l(e,t),s(e,[{key:"addFile",value:function(t,e,r){var n=!1,i=e.name,o=i.split(".").pop();if(p.isArray(this.limit)){for(var u=0,l=this.limit.length;l>u;u+=1)if(o===this.limit[u]){n=!0;break}}else("*"===this.limit||o===this.limit)&&(n=!0);return n?(this.files.push(a({},r,e)),this.formData[r]=e,this.data.append(t,e,r),this.emit("upload.addFile",e)):this.emit("upload.fileExtnameNotMatch",e),this}},{key:"addData",value:function(t,e){return this.formData[t]=e,this.data.append(t,e),this.emit("upload.addData",a({},t,e)),this}},{key:"start",value:function(){return this.files.length?this.url?(f(Object.getPrototypeOf(e.prototype),"send",this).call(this),this.emit("upload.start"),this):void e.Error("NO_URL"):void e.Error("NO_FILES")}},{key:"bind",value:function(t){var r=this;if(!t)return void e.Error("NO_ELEMENT");var n=document.createElement("input");n.setAttribute("type","file"),this.multiple&&n.setAttribute("multiple",!0),n.addEventListener("change",function(){if(n.files.length){var t=!0,e=!1,i=void 0;try{for(var a,o=Object.keys(n.files)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var u=a.value;r.addFile("file",n.files[u],n.files[u].name)}}catch(l){e=!0,i=l}finally{try{!t&&o["return"]&&o["return"]()}finally{if(e)throw i}}r.auto&&r.start()}}),t.addEventListener("click",function(){n.click()})}}],[{key:"Error",value:function(t){var e=void 0;switch(t){case"NOT_SUPPORT":e="Browser not support "+(arguments.length<=1?void 0:arguments[1]);break;case"NOT_INIT":e="Uploader haven't inited.";break;case"NO_FILES":e="Target file is empty.";break;case"NO_URL":e="No upload url provided.";break;case"NO_ELEMENT":e="No element to trigger select file."}if(e)throw"Uploader Error: "+e}}]),e}(d["default"]);r["default"]=y},{"./ajax":2,"./util":4}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.extend=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;e>n;n++)r[n-1]=arguments[n];var i=!0,a=!1,o=void 0;try{for(var u,l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var s=u.value;for(var f in s)s.hasOwnProperty(f)&&(t[f]=s[f])}}catch(c){a=!0,o=c}finally{try{!i&&l["return"]&&l["return"]()}finally{if(a)throw o}}return t},r.notEmpty=function(t){var e=void 0,r=!1;if(Object.keys)r=!!Object.keys(t).length;else for(e in t)if(t.hasOwnProperty(e)){r=!0;break}return r},r.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}},{}]},{},[1]);
//# sourceMappingURL=uploader.min.js.map
