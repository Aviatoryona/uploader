{"version":3,"sources":["node_modules/browser-pack/_prelude.js","uploader.min.js","index.js","lib/ajax.js","lib/uploader.js","lib/util.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","_uploader","_uploader2","window","Uploader","./lib/uploader.js",2,"_interopRequireWildcard","newObj","key","Object","prototype","hasOwnProperty","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","value","_util","util","Ajax","option","_this","this","defaultOption","url","method","params","data","xhr","XMLHttpRequest","status","callbackList","headers","extend","addEventListener","response","JSON","parse","emit","event","percent","undefined","lengthComputable","loaded","total","notEmpty","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","keys","Symbol","iterator","next","done","setHeader","err","tmpArr","push","join","open","setRequestHeader","send","abort","name","type","callback","context","once","fn","list","_len","arguments","arg","Array","_key","apply","splice","errorMsg","./util",3,"_defineProperty","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","_ajax","_ajax2","files","limit","formData","multiple","auto","progressEvent","_Ajax","FormData","File","Blob","upload","on","args","concat","_files","addData","start","file","filename","flag","extname","split","pop","isArray","append","element","_this2","input","document","createElement","setAttribute","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","addFile","click","set","arr","_this3","_formData","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","item","reset","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","forEach","./ajax",4,"src","dist","j","toString"],"mappings":"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","file":"uploader.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _uploader = require('./lib/uploader.js');\n\nvar _uploader2 = _interopRequireDefault(_uploader);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nwindow.Uploader = _uploader2.default;\n\n},{\"./lib/uploader.js\":3}],2:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _util = require('./util');\n\nvar util = _interopRequireWildcard(_util);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Ajax = (function () {\n    function Ajax(option) {\n        var _this = this;\n\n        _classCallCheck(this, Ajax);\n\n        var defaultOption = {\n            url: null,\n            method: 'GET',\n            params: {},\n            data: null,\n            xhr: new XMLHttpRequest(),\n            status: 'pending',\n            callbackList: [],\n            headers: {}\n        };\n        if (typeof XMLHttpRequest === 'undefined') {\n            Ajax.Error('NOT_SUPPORT');\n            return;\n        }\n        util.extend(this, defaultOption, option);\n        this.xhr.addEventListener('load', function () {\n            var response = _this.xhr.response;\n            _this.status = 'complete';\n            if (_this.xhr.status === 200) {\n                try {\n                    response = JSON.parse(response);\n                } catch (e) {}\n                _this.emit('success', response);\n            } else {\n                _this.emit('error', _this.xhr);\n            }\n        });\n        this.xhr.addEventListener('progress', function (event) {\n            var percent = undefined;\n            _this.status = 'uploading';\n            percent = event.lengthComputable ? event.loaded / event.total : 0;\n            _this.emit('progress', event, percent);\n        });\n        this.xhr.addEventListener('error', function (e) {\n            _this.emit('error', e);\n        });\n        this.xhr.addEventListener('abort', function (e) {\n            _this.emit('abort', e);\n        });\n        if (util.notEmpty(this.headers)) {\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = Object.keys(this.headers)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var i = _step.value;\n\n                    this.setHeader(i, this.headers[i]);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n        }\n        return this;\n    }\n\n    _createClass(Ajax, [{\n        key: 'send',\n        value: function send() {\n            if (!this.url) {\n                Ajax.Error('NO_URL');\n                return;\n            }\n            var url = this.url;\n            var tmpArr = [];\n            for (var i in this.params) {\n                if (this.params.hasOwnProperty(i)) {\n                    tmpArr.push(i + '=' + this.params[i]);\n                }\n            }\n            url = tmpArr.length ? url + '?' + tmpArr.join('&') : url;\n            this.xhr.open(this.method, url);\n            if (util.notEmpty(this.headers)) {\n                for (var i in this.headers) {\n                    if (this.headers.hasOwnProperty(i)) {\n                        this.xhr.setRequestHeader(i, this.headers[i]);\n                    }\n                }\n            }\n            this.xhr.send(this.data);\n            return this;\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this.xhr.abort();\n            return this;\n        }\n    }, {\n        key: 'setHeader',\n        value: function setHeader(name, value) {\n            this.headers[name] = value;\n            return this;\n        }\n    }, {\n        key: 'on',\n        value: function on(type, callback, context, once) {\n            this.callbackList[type] = this.callbackList[type] || [];\n            this.callbackList[type].push({ fn: callback, context: context, once: once });\n            return this;\n        }\n    }, {\n        key: 'emit',\n        value: function emit(type) {\n            if (this.callbackList[type] && this.callbackList[type].length) {\n                var i = 0;\n                var list = this.callbackList[type];\n\n                for (var _len = arguments.length, arg = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                    arg[_key - 1] = arguments[_key];\n                }\n\n                for (; i < list.length; i += 1) {\n                    var obj = list[i];\n                    obj.fn.apply(obj.context, arg);\n                    if (obj.once) {\n                        list.splice(i, 1);\n                        i -= 1;\n                    }\n                }\n            }\n        }\n    }], [{\n        key: 'Error',\n        value: function Error(type) {\n            var errorMsg = undefined;\n            switch (type) {\n                case 'NOT_SUPPORT':\n                    errorMsg = 'Browser not support XMLHttpRequest.';\n                    break;\n                case 'NO_URL':\n                    errorMsg = 'No url provided.';\n                    break;\n            }\n            if (errorMsg) {\n                throw 'Ajax Error: ' + errorMsg;\n            }\n        }\n    }]);\n\n    return Ajax;\n})();\n\nexports.default = Ajax;\n\n},{\"./util\":4}],3:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ajax = require('./ajax');\n\nvar _ajax2 = _interopRequireDefault(_ajax);\n\nvar _util = require('./util');\n\nvar util = _interopRequireWildcard(_util);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar defaultOption = {\n    files: [],\n    limit: '*',\n    formData: {},\n    multiple: false,\n    auto: false,\n    method: 'POST',\n    // 是否监听上传事件。如果监听上传事件的话，会强制将请求 preflight，\n    // 如果服务器没有为 option 方法配制跨域请求头的话 则会上传失败。\n    progressEvent: true\n};\n\nvar Uploader = (function (_Ajax) {\n    _inherits(Uploader, _Ajax);\n\n    function Uploader(option) {\n        _classCallCheck(this, Uploader);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Uploader).call(this, util.extend(defaultOption, option)));\n\n        if (typeof FormData === 'undefined') {\n            Uploader.Error('NOT_SUPPORT', 'FormData');\n            return _possibleConstructorReturn(_this);\n        }\n        if (typeof File === 'undefined') {\n            Uploader.Error('NOT_SUPPORT', 'File');\n            return _possibleConstructorReturn(_this);\n        }\n        if (typeof Blob === 'undefined') {\n            Uploader.Error('NOT_SUPPORT', 'Blob');\n            return _possibleConstructorReturn(_this);\n        }\n        _this.data = new FormData();\n        if (_this.progressEvent) {\n            _this.upload = _this.xhr.upload;\n            _this.upload.addEventListener('progress', function (event) {\n                var percent = undefined;\n                _this.status = 'uploading';\n                percent = event.lengthComputable ? event.loaded / event.total : 0;\n                _this.emit('upload.progress', event, percent);\n            });\n            _this.upload.addEventListener('error', function (e) {\n                _this.status = 'error';\n                _this.emit('upload.error', e);\n            });\n            _this.upload.addEventListener('abort', function (e) {\n                _this.status = 'abort';\n                _this.emit('upload.abort', e);\n            });\n        }\n        _this.on('success', function () {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            _this.status = 'success';\n            _this.emit.apply(_this, ['upload.success'].concat(args));\n        });\n        _this._files = [];\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n            for (var _iterator = Object.keys(_this.formData)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var i = _step.value;\n\n                _this.addData(i, _this.formData[i]);\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        if (_this.auto) {\n            _this.start();\n        }\n        return _this;\n    }\n\n    _createClass(Uploader, [{\n        key: 'addFile',\n        value: function addFile(key, file, filename) {\n            var flag = false;\n            var name = file.name;\n            var extname = name.split('.').pop();\n\n            if (util.isArray(this.limit)) {\n                for (var i = 0, l = this.limit.length; i < l; i += 1) {\n                    if (extname === this.limit[i]) {\n                        flag = true;\n                        break;\n                    }\n                }\n            } else if (this.limit === '*' || extname === this.limit) {\n                flag = true;\n            }\n            if (flag) {\n                this._files.push(_defineProperty({}, filename, file));\n                this.formData[filename] = file;\n                this.data.append(key, file, filename);\n                this.emit('upload.addFile', file);\n            } else {\n                this.emit('upload.fileExtnameNotMatch', file);\n            }\n            return this;\n        }\n    }, {\n        key: 'addData',\n        value: function addData(key, value) {\n            this.formData[key] = value;\n            this.data.append(key, value);\n            this.emit('upload.addData', _defineProperty({}, key, value));\n            return this;\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            if (!this.files.length) {\n                Uploader.Error('NO_FILES');\n                return;\n            }\n            if (!this.url) {\n                Uploader.Error('NO_URL');\n                return;\n            }\n            _get(Object.getPrototypeOf(Uploader.prototype), 'send', this).call(this);\n            this.emit('upload.start');\n            return this;\n        }\n    }, {\n        key: 'bind',\n        value: function bind(element) {\n            var _this2 = this;\n\n            if (!element) {\n                Uploader.Error('NO_ELEMENT');\n                return;\n            }\n            var input = document.createElement('input');\n            input.setAttribute('type', 'file');\n            if (this.multiple) {\n                input.setAttribute('multiple', true);\n            }\n            input.addEventListener('change', function () {\n                if (input.files.length) {\n                    var _iteratorNormalCompletion2 = true;\n                    var _didIteratorError2 = false;\n                    var _iteratorError2 = undefined;\n\n                    try {\n                        for (var _iterator2 = Object.keys(input.files)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                            var i = _step2.value;\n\n                            _this2.addFile('file', input.files[i], input.files[i].name);\n                        }\n                    } catch (err) {\n                        _didIteratorError2 = true;\n                        _iteratorError2 = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                                _iterator2.return();\n                            }\n                        } finally {\n                            if (_didIteratorError2) {\n                                throw _iteratorError2;\n                            }\n                        }\n                    }\n\n                    _this2.start();\n                }\n            });\n            element.addEventListener('click', function () {\n                input.click();\n            });\n\n            return this;\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this.formData = {};\n            this._files = [];\n            this.files = [];\n            this.status = 'pending';\n            this.data = new FormData();\n        }\n    }, {\n        key: 'files',\n        get: function get() {\n            return this._files;\n        },\n        set: function set(arr) {\n            var _this3 = this;\n\n            if (util.isArray(arr) && arr.length) {\n                var _formData = this.formData;\n                var formData = {};\n                var _iteratorNormalCompletion3 = true;\n                var _didIteratorError3 = false;\n                var _iteratorError3 = undefined;\n\n                try {\n                    for (var _iterator3 = Object.keys(_formData)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                        var i = _step3.value;\n\n                        var item = _formData[i];\n                        if (!(item instanceof File || item instanceof Blob)) {\n                            formData[i] = item;\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError3 = true;\n                    _iteratorError3 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                            _iterator3.return();\n                        }\n                    } finally {\n                        if (_didIteratorError3) {\n                            throw _iteratorError3;\n                        }\n                    }\n                }\n\n                this.reset();\n                this.formData = formData;\n                var _iteratorNormalCompletion4 = true;\n                var _didIteratorError4 = false;\n                var _iteratorError4 = undefined;\n\n                try {\n                    for (var _iterator4 = Object.keys(this.formData)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                        var i = _step4.value;\n\n                        this.data.append(i, this.formData[i]);\n                    }\n                } catch (err) {\n                    _didIteratorError4 = true;\n                    _iteratorError4 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                            _iterator4.return();\n                        }\n                    } finally {\n                        if (_didIteratorError4) {\n                            throw _iteratorError4;\n                        }\n                    }\n                }\n\n                arr.forEach(function (item) {\n                    _this3.addFile('file', item, item.name || 'file');\n                });\n            }\n        }\n    }], [{\n        key: 'Error',\n        value: function Error(type) {\n            var errorMsg = undefined;\n            switch (type) {\n                case 'NOT_SUPPORT':\n                    errorMsg = 'Browser not support ' + (arguments.length <= 1 ? undefined : arguments[1]);\n                    break;\n                case 'NOT_INIT':\n                    errorMsg = 'Uploader haven\\'t inited.';\n                    break;\n                case 'NO_FILES':\n                    errorMsg = 'Target file is empty.';\n                    break;\n                case 'NO_URL':\n                    errorMsg = 'No upload url provided.';\n                    break;\n                case 'NO_ELEMENT':\n                    errorMsg = 'No element to trigger select file.';\n                    break;\n            }\n            if (errorMsg) {\n                throw 'Uploader Error: ' + errorMsg;\n            }\n        }\n    }]);\n\n    return Uploader;\n})(_ajax2.default);\n\nexports.default = Uploader;\n\n},{\"./ajax\":2,\"./util\":4}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar extend = exports.extend = function extend(src) {\n    for (var _len = arguments.length, dist = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        dist[_key - 1] = arguments[_key];\n    }\n\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n        for (var _iterator = dist[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var i = _step.value;\n\n            for (var j in i) {\n                if (i.hasOwnProperty(j)) {\n                    src[j] = i[j];\n                }\n            }\n        }\n    } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n    } finally {\n        try {\n            if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n            }\n        } finally {\n            if (_didIteratorError) {\n                throw _iteratorError;\n            }\n        }\n    }\n\n    return src;\n};\n\nvar notEmpty = exports.notEmpty = function notEmpty(obj) {\n    var i = undefined;\n    var flag = false;\n    if (Object.keys) {\n        flag = !!Object.keys(obj).length;\n    } else {\n        for (i in obj) {\n            if (obj.hasOwnProperty(i)) {\n                flag = true;\n                break;\n            }\n        }\n    }\n    return flag;\n};\n\nvar isArray = exports.isArray = function isArray(obj) {\n    if (Array.isArray) {\n        return Array.isArray(obj);\n    } else {\n        return Object.prototype.toString.call(obj) === '[object Array]';\n    }\n};\n\n},{}]},{},[1])\n\n","import Uploader from './lib/uploader.js';\r\n\r\nwindow.Uploader = Uploader;","import * as util from './util';\r\n\r\n\r\nexport default class Ajax {\r\n    constructor (option) {\r\n        const defaultOption = {\r\n            url: null,\r\n            method: 'GET',\r\n            params: {},\r\n            data: null,\r\n            xhr: new XMLHttpRequest(),\r\n            status: 'pending',\r\n            callbackList: [],\r\n            headers: {}\r\n        };\r\n        if (typeof XMLHttpRequest === 'undefined') {\r\n            Ajax.Error('NOT_SUPPORT');\r\n            return;\r\n        }\r\n        util.extend(this, defaultOption, option);\r\n        this.xhr.addEventListener('load', () => {\r\n            let response = this.xhr.response;\r\n            this.status = 'complete';\r\n            if (this.xhr.status === 200) {\r\n                try {\r\n                    response = JSON.parse(response);\r\n                } catch (e) {}\r\n                this.emit('success', response);\r\n            } else {\r\n                this.emit('error', this.xhr);\r\n            }\r\n        });\r\n        this.xhr.addEventListener('progress', (event) => {\r\n            let percent;\r\n            this.status = 'uploading';\r\n            percent = event.lengthComputable ? (event.loaded / event.total) : 0;\r\n            this.emit('progress', event, percent);\r\n        });\r\n        this.xhr.addEventListener('error', (e) => {\r\n            this.emit('error', e);\r\n        });\r\n        this.xhr.addEventListener('abort', (e) => {\r\n            this.emit('abort', e);\r\n        });\r\n        if (util.notEmpty(this.headers)) {\r\n            for (let i of Object.keys(this.headers)) {\r\n                this.setHeader(i, this.headers[i]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    static Error (type) {\r\n        let errorMsg;\r\n        switch (type) {\r\n            case 'NOT_SUPPORT':\r\n                errorMsg = 'Browser not support XMLHttpRequest.';\r\n                break;\r\n            case 'NO_URL':\r\n                errorMsg = 'No url provided.';\r\n                break;\r\n        }\r\n        if (errorMsg) {\r\n            throw `Ajax Error: ${errorMsg}`;\r\n        }\r\n    }\r\n    send () {\r\n        if (!this.url) {\r\n            Ajax.Error('NO_URL');\r\n            return;\r\n        }\r\n        let url = this.url;\r\n        let tmpArr = [];\r\n        for (let i in this.params) {\r\n            if (this.params.hasOwnProperty(i)) {\r\n                tmpArr.push(`${i}=${this.params[i]}`);\r\n            }\r\n        }\r\n        url = tmpArr.length ? `${url}?${tmpArr.join('&')}` : url;\r\n        this.xhr.open(this.method, url);\r\n        if (util.notEmpty(this.headers)) {\r\n            for (let i in this.headers) {\r\n                if (this.headers.hasOwnProperty(i)) {\r\n                    this.xhr.setRequestHeader(i, this.headers[i]);\r\n                }\r\n            }\r\n        }\r\n        this.xhr.send(this.data);\r\n        return this;\r\n    }\r\n    abort () {\r\n        this.xhr.abort();\r\n        return this;\r\n    }\r\n    setHeader (name, value) {\r\n        this.headers[name] = value;\r\n        return this;\r\n    }\r\n    on (type, callback, context, once) {\r\n        this.callbackList[type] = this.callbackList[type] || [];\r\n        this.callbackList[type].push({fn: callback, context, once});\r\n        return this;\r\n    }\r\n    emit (type, ...arg) {\r\n        if (this.callbackList[type] && this.callbackList[type].length) {\r\n            let i = 0;\r\n            let list = this.callbackList[type];\r\n            for (; i < list.length; i += 1) {\r\n                let obj = list[i];\r\n                obj.fn.apply(obj.context, arg);\r\n                if (obj.once) {\r\n                    list.splice(i, 1);\r\n                    i -= 1;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import Ajax      from './ajax';\r\nimport * as util from './util';\r\n\r\nconst defaultOption = {\r\n    files        : [],\r\n    limit        : '*',\r\n    formData     : {},\r\n    multiple     : false,\r\n    auto         : false,\r\n    method       : 'POST',\r\n    // 是否监听上传事件。如果监听上传事件的话，会强制将请求 preflight，\r\n    // 如果服务器没有为 option 方法配制跨域请求头的话 则会上传失败。\r\n    progressEvent: true\r\n};\r\n\r\nexport default class Uploader extends Ajax {\r\n    constructor (option) {\r\n        super(util.extend(defaultOption, option));\r\n        if (typeof FormData === 'undefined') {\r\n            Uploader.Error('NOT_SUPPORT', 'FormData');\r\n            return;\r\n        }\r\n        if (typeof File === 'undefined') {\r\n            Uploader.Error('NOT_SUPPORT', 'File');\r\n            return;\r\n        }\r\n        if (typeof Blob === 'undefined') {\r\n            Uploader.Error('NOT_SUPPORT', 'Blob');\r\n            return;\r\n        }\r\n        this.data = new FormData();\r\n        if (this.progressEvent) {\r\n            this.upload = this.xhr.upload;\r\n            this.upload.addEventListener('progress', (event) => {\r\n                let percent;\r\n                this.status = 'uploading';\r\n                percent = event.lengthComputable ? (event.loaded / event.total) : 0;\r\n                this.emit('upload.progress', event, percent);\r\n            });\r\n            this.upload.addEventListener('error', (e) => {\r\n                this.status = 'error';\r\n                this.emit('upload.error', e);\r\n            });\r\n            this.upload.addEventListener('abort', (e) => {\r\n                this.status = 'abort';\r\n                this.emit('upload.abort', e);\r\n            });\r\n        }\r\n        this.on('success', (...args) => {\r\n            this.status = 'success';\r\n            this.emit.apply(this, ['upload.success'].concat(args));\r\n        });\r\n        this._files = [];\r\n        for (let i of Object.keys(this.formData)) {\r\n            this.addData(i, this.formData[i]);\r\n        }\r\n        if (this.auto) {\r\n            this.start();\r\n        }\r\n    }\r\n    static Error (type, ...msg) {\r\n        let errorMsg;\r\n        switch (type) {\r\n            case 'NOT_SUPPORT':\r\n                errorMsg = `Browser not support ${msg[0]}`;\r\n                break;\r\n            case 'NOT_INIT':\r\n                errorMsg = 'Uploader haven\\'t inited.';\r\n                break;\r\n            case 'NO_FILES':\r\n                errorMsg = 'Target file is empty.';\r\n                break;\r\n            case 'NO_URL':\r\n                errorMsg = 'No upload url provided.';\r\n                break;\r\n            case 'NO_ELEMENT':\r\n                errorMsg = 'No element to trigger select file.';\r\n                break;\r\n        }\r\n        if (errorMsg) {\r\n            throw `Uploader Error: ${errorMsg}`;\r\n        }\r\n    }\r\n    addFile (key, file, filename) {\r\n        let flag = false;\r\n        let name = file.name;\r\n        let extname = name.split('.').pop();\r\n\r\n        if (util.isArray(this.limit)) {\r\n            for (let i = 0, l = this.limit.length; i < l; i += 1) {\r\n                if (extname === this.limit[i]) {\r\n                    flag = true;\r\n                    break;\r\n                }\r\n            }\r\n        } else if (this.limit === '*' || extname === this.limit) {\r\n            flag = true;\r\n        }\r\n        if (flag) {\r\n            this._files.push({[filename]: file});\r\n            this.formData[filename] = file;\r\n            this.data.append(key, file, filename);\r\n            this.emit('upload.addFile', file);\r\n        } else {\r\n            this.emit('upload.fileExtnameNotMatch', file);\r\n        }\r\n        return this;\r\n    }\r\n    addData (key, value) {\r\n        this.formData[key] = value;\r\n        this.data.append(key, value);\r\n        this.emit('upload.addData', {[key]: value});\r\n        return this;\r\n    }\r\n    start () {\r\n        if (!this.files.length) {\r\n            Uploader.Error('NO_FILES');\r\n            return;\r\n        }\r\n        if (!this.url) {\r\n            Uploader.Error('NO_URL');\r\n            return;\r\n        }\r\n        super.send();\r\n        this.emit('upload.start');\r\n        return this;\r\n    }\r\n    bind (element) {\r\n        if (!element) {\r\n            Uploader.Error('NO_ELEMENT');\r\n            return;\r\n        }\r\n        let input = document.createElement('input');\r\n        input.setAttribute('type', 'file');\r\n        if (this.multiple) {\r\n            input.setAttribute('multiple', true);\r\n        }\r\n        input.addEventListener('change', () => {\r\n            if (input.files.length) {\r\n                for (let i of Object.keys(input.files)) {\r\n                    this.addFile('file', input.files[i], input.files[i].name);\r\n                }\r\n                this.start();\r\n            }\r\n        });\r\n        element.addEventListener('click', () => {\r\n            input.click();\r\n        });\r\n\r\n        return this;\r\n    }\r\n    reset () {\r\n        this.formData = {};\r\n        this._files   = [];\r\n        this.files    = [];\r\n        this.status   = 'pending'\r\n        this.data     = new FormData();\r\n    }\r\n    get files () {\r\n        return this._files;\r\n    }\r\n    set files (arr) {\r\n        if (util.isArray(arr) && arr.length) {\r\n            let _formData = this.formData;\r\n            let formData  = {};\r\n            for (let i of Object.keys(_formData)) {\r\n                let item = _formData[i];\r\n                if (!(item instanceof File || item instanceof Blob)) {\r\n                    formData[i] = item;\r\n                }\r\n            }\r\n            this.reset();\r\n            this.formData = formData;\r\n            for (let i of Object.keys(this.formData)) {\r\n                this.data.append(i, this.formData[i]);\r\n            }\r\n            arr.forEach((item) => { \r\n                this.addFile('file', item, item.name || 'file'); \r\n            });\r\n        }\r\n    }\r\n}","export const extend = (src, ...dist) => {\r\n    for (let i of dist) {\r\n        for (let j in i) {\r\n            if (i.hasOwnProperty(j)) {\r\n                src[j] = i[j];\r\n            }\r\n        }\r\n    }\r\n    return src;\r\n};\r\n\r\n\r\nexport const notEmpty = (obj) => {\r\n    let i;\r\n    let flag = false;\r\n    if (Object.keys) {\r\n        flag = !!Object.keys(obj).length;\r\n    } else {\r\n        for (i in obj) {\r\n            if (obj.hasOwnProperty(i)) {\r\n                flag = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return flag;\r\n};\r\n\r\nexport const isArray = (obj) => {\r\n    if (Array.isArray) {\r\n        return Array.isArray(obj);\r\n    } else {\r\n        return Object.prototype.toString.call(obj) === '[object Array]';\r\n    }\r\n};"],"sourceRoot":"/source/"}